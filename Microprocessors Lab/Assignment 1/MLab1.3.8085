IN 10H
MVI E,00H  ;E is for the LSB LEDs. When it reaches 16 it resets to 0.
MVI B,00H  ;for DELB. 1/10 of a 
MVI C,64H  ;sec is 100msec, so 0064H
MVI D,00H  ;D is for the program to remeber if we have interrupts on or off 
	    ;after using DELB
MVI L,00H  ;L is the counter of interrupts (4 MSB)

MAIN:
LDA 2000H
ANI 80H
CPI 80H
JZ INTRPT_ON 
CPI 00H
JZ INTRPT_OFF

MAIN_LOOP:
MVI A,00H
MOV A,L ;
CMA	 ;
RLC	 ;
RLC	 ; Making the 4 MSB of A 
RLC	 ; equal to L
RLC	 ;
ANI F0H ;	
ADD E		
STA 3000H	
DI	;Interrupts are disabled during DELB
CALL DELB
MOV A,D		;
ANI 80H		; Checking if interrupts were enabled before DELB
CPI 80H		;
JZ INTRPT_ON_2	;

MAIN_LOOP_2:
MOV A,E
INR A
MOV E,A
CPI 0FH
JNZ MAIN	; If E > 16 reset it.
MVI E,00H	;
JMP MAIN

INTRPT_ON:
MVI A,0DH
MVI D,80H
SIM 
EI
JMP MAIN_LOOP

INTRPT_ON_2:
EI
JMP MAIN_LOOP_2

INTRPT_OFF:
DI
MVI D,00H
JMP MAIN_LOOP

INTR_ROUTINE:
DI
PUSH PSW
PUSH B
PUSH D

ROUTINE_1:
RIM		;
ANI 20H	;
CPI 20H	;
JZ ROUTINE_1	;
MVI C,32H	;Flowchart no.1 from 8085 from laboratory notes
MVI B,00H	;page 60
CALL DELB	;
RIM		;
ANI 20H	;
CPI 20H	;
JZ ROUTINE_1	;
INR L		
MOV A,L
ANI 0FH
MOV L,A
POP D
POP B
POP PSW
EI
RET

HLT
END
