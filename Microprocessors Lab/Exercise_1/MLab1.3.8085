IN 10H
MVI E,00H
MVI B,00H
MVI C,0AH
MVI D,00H
MVI L,00H
MAIN:
LDA 2000H
ANI 80H
CPI 80H
JZ INTRPT_ON
CPI 00H
JZ INTRPT_OFF

MAIN_LOOP:
MVI A,00H
MOV A,L
CMA
RLC
RLC
RLC
RLC
ANI F0H
ADD E
STA 3000H
DI
CALL DELB
MOV A,D
ANI 80H
CPI 80H
JZ INTRPT_ON_2

MAIN_LOOP_2:
MOV A,E
INR A
MOV E,A
CPI 0FH
JNZ MAIN
MVI E,00H
JMP MAIN

INTRPT_ON:
MVI A,0DH
MVI D,01H
SIM 
EI
JMP MAIN_LOOP

INTRPT_ON_2:
EI
JMP MAIN_LOOP_2

INTRPT_OFF:
DI
JMP MAIN_LOOP

INTR_ROUTINE:
DI
PUSH PSW
PUSH B
PUSH D

ROUTINE_1:
RIM
ANI 20H
CPI 20H
JZ ROUTINE_1
MVI C,32H
MVI B,00H
CALL DELB
RIM
ANI 20H
CPI 20H
JZ ROUTINE_1
INR L
MOV A,L
ANI 0FH
MOV L,A
POP D
POP B
POP PSW
EI
RET

HLT
END
